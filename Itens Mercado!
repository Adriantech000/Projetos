#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>

struct produtos {
    int codigo[20]; // código dos itens
    char itens[20][100]; // vetor para os produtos
    char marca[20][100]; // vetor para as marcas
    float valor[20]; // preços
};

void lista(int qnt, struct produtos *ite);
void mudar(struct produtos *ite, int qnt);
void adicionar(int *qnt, struct produtos *ite, int *ultimoiten);
void remover(int *qnt, struct produtos *ite, int *ultimoiten);

int main() {
    struct produtos ite;
    int qnt = 0; // quantidade de itens, começando com 0
    int ultimoiten = 0; // último item adicionado
    srand(time(NULL)); // geração de números aleatórios

    int cont;
    printf("Quantos itens você deseja adicionar? ");
    scanf("%d", &qnt);
    getchar(); // limpar o buffer

    for (cont = 0; cont < qnt; cont++) {
        printf("------------------------------------\n");
        printf("Digite o Nome do item %d:\n", cont + 1);
        scanf(" %[^\n]", ite.itens[cont]);
        printf("Digite a marca do item %d:\n", cont + 1);
        scanf(" %[^\n]", ite.marca[cont]);
        printf("Qual o valor do item %d:\n", cont + 1);
        scanf("%f", &ite.valor[cont]);
        ite.codigo[cont] = rand() % 100; // Gerando código aleatório
        ultimoiten++;
    }

    int escolha;
    do {
        printf("Menu\n");
        printf("1 - Ver a lista de itens\n");
        printf("2 - Alterar algum item\n");
        printf("3 - Adicionar item\n");
        printf("4 - Remover item\n");
        printf("5 - Encerrar programa\n");
        printf("------------------------------------\n");
        scanf("%d", &escolha);

        switch (escolha) {
            case 1:
                lista(ultimoiten, &ite);
                break;
            case 2:
                mudar(&ite, ultimoiten);
                break;
            case 3:
                adicionar(&qnt, &ite, &ultimoiten);
                break;
            case 4:
                remover(&qnt, &ite, &ultimoiten);
                break;
            case 5:
                printf("Encerrando o programa...\n");
                break;
            default:
                printf("Escolha inválida! Tente novamente.\n");
        }
    } while (escolha != 5);

    return 0;
}

void lista(int qnt, struct produtos *ite) {
    for (int cont = 0; cont < qnt; cont++) {
        printf("Item número %d\n", cont + 1);
        printf("Nome: %s\n", ite->itens[cont]);
        printf("Marca: %s\n", ite->marca[cont]);
        printf("Valor: %.2f \n", ite->valor[cont]); 
        printf("Código: %d\n", ite->codigo[cont]);
        printf("------------------------------------\n");
    }
}

void mudar(struct produtos *ite, int qnt) {
    int escolha;
    printf("Qual item quer alterar? \nNúmero do item: ");
    scanf("%d", &escolha);

    if (escolha < 1 || escolha > qnt) {
        printf("Número de item inválido!\n");
        return;
    }

    escolha--; // Ajusta para índice zero
    printf("------------------------------------\n");
    printf("Digite o Nome do item %d:\n", escolha + 1);
    scanf(" %[^\n]", ite->itens[escolha]);
    printf("Digite a marca do item %d:\n", escolha + 1);
    scanf(" %[^\n]", ite->marca[escolha]);
    printf("Qual o valor do item %d:\n", escolha + 1);
    scanf("%f", &ite->valor[escolha]);
}

void adicionar(int *qnt, struct produtos *ite, int *ultimoiten) {
    if (*ultimoiten >= 20) {
        printf("Não é possível adicionar mais itens.\n");
        return;
    }

    printf("------------------------------------\n");
    printf("Digite o Nome do item %d:\n", *ultimoiten + 1);
    scanf(" %[^\n]", ite->itens[*ultimoiten]);
    printf("Digite a marca do item %d:\n", *ultimoiten + 1);
    scanf(" %[^\n]", ite->marca[*ultimoiten]);
    printf("Qual o valor do item %d:\n", *ultimoiten + 1);
    scanf("%f", &ite->valor[*ultimoiten]);
    ite->codigo[*ultimoiten] = rand() % 100; // Gerar código aleatório
    (*ultimoiten)++;
}

void remover(int *qnt, struct produtos *ite, int *ultimoiten) {
    int escolha;
    printf("Qual item deseja remover? ");
    scanf("%d", &escolha);

    if (escolha < 1 || escolha > *ultimoiten) {
        printf("Número de item inválido!\n");
        return;
    }

    escolha--; // Ajusta para índice zero

    // Move os itens para preencher o espaço vazio
    for (int j = escolha; j < *ultimoiten - 1; j++) {
        strcpy(ite->itens[j], ite->itens[j + 1]); 
        strcpy(ite->marca[j], ite->marca[j + 1]);
        ite->valor[j] = ite->valor[j + 1];
        ite->codigo[j] = ite->codigo[j + 1];
    }

    (*ultimoiten)--; // Reduz o número total de itens
    printf("Item removido com sucesso.\n");
}
